\input{latex/preamble.tex}

\begin{abstract}
In this report we have presented three different numerical methods to solve the diffusion equation in one dimension. The three presented methods are the Forward Euler, Backward Euler and Crank-Nicolson scheme. We will see that the we have to use the Forward Euler with precaution as it may give erroneous results. However, this will not be the case for the Backward Euler and Crank-Nicolson. We will also see that the Crank-Nicolson gives us the most accurate results. 
Furthermore, we will look at a similar solver for solving the equation in two dimensions using the very same idea as for the Forward Euler in one dimension. 
\end{abstract}
\listoftodos
\clearpage

\input{latex/introduction.tex}

\input{latex/physics.tex}

%                       _ _
%   ___  _ __   ___  __| (_)_ __ ___
%  / _ \| '_ \ / _ \/ _` | | '_ ` _ \
% | (_) | | | |  __/ (_| | | | | | | |
%  \___/|_| |_|\___|\__,_|_|_| |_| |_|
\section{Mathematical theory in one dimension}
Before we can begin our analysis on how it is possible to numerically solve the diffusion equation, we will first take a look at the analytical solution. This analytical solution can be used in von Neumann analysis to find requirements for the numerical parameters to ensure that a reasonable solution is found.
\input{latex/analyticalonedim.tex}

\input{latex/discretisation.tex}

\input{latex/forwardeuler.tex}

\input{latex/backwardeuler.tex}

\input{latex/cranknicolson.tex}

%  _                           _ _
% | |___      _____         __| (_)_ __ ___
% | __\ \ /\ / / _ \ _____ / _` | | '_ ` _ \
% | |_ \ V  V / (_) |_____| (_| | | | | | | |
%  \__| \_/\_/ \___/       \__,_|_|_| |_| |_|
\section{Mathematical theory in two dimensions}
The derivation of Fick's laws can be generalised to higher dimensions, giving
\[
    \vec{J} = -D\nabla C \qquad\qquad \pdv{C}{t} = D\nabla^2C
\]
Our differential equation can therefore be written in two dimensions as
\begin{equation} \label{eq:twoDim}
\pdv[2]{u}{x} + \pdv[2]{u}{y} = \pdv{u}{t}
\end{equation}

Time and position are again discretised, with the notation \(u_{i,j,k} = u(x_i,y_j,t_k)\). For all simulations, \(\Delta y\) will be set equal to \(\Delta x\).

\input{latex/analyticaltwodim.tex}

\input{latex/eulertwodim.tex}

\input{latex/implementation.tex}

\input{latex/onedimres.tex}

\input{latex/twodimres.tex}

\clearpage
\addcontentsline{toc}{section}{References}
\nocite{tveito2004introduction}
\printbibliography
\newpage

%\setcounter{section}{0}
%\renewcommand{\thesection}{Appendix \Alph{section}}
\input{latex/appendix.tex}


\end{document}
