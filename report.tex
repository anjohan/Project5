\input{latex/preamble.tex}
\clearpage
\begin{abstract}
In this report we derive, analyse and implement three different numerical methods for solving the diffusion equation in one dimension. The three presented methods are the Forward Euler, Backward Euler and Crank-Nicolson schemes. As is shown analytically through von Neumann stability analysis and confirmed numerically, the Forward Euler scheme sets a criterion for the ratio of the spatial and temporal step lengths, while the other schemes always give stable results. The truncation errors are also analytically derived and numerically verified by comparison with the analytical solution, with the Crank-Nicolson scheme giving the best results.

We also derive the basic physical theory of diffusion, and develop a script for animating the process for easy visualisation. Finally, a simple, explicit method is derived and implemented for simulating two-dimensional diffusion, as well as an analytical solution for comparison.
\end{abstract}

\input{latex/introduction.tex}

\clearpage
\input{latex/physics.tex}

%                       _ _
%   ___  _ __   ___  __| (_)_ __ ___
%  / _ \| '_ \ / _ \/ _` | | '_ ` _ \
% | (_) | | | |  __/ (_| | | | | | | |
%  \___/|_| |_|\___|\__,_|_|_| |_| |_|
\clearpage
\section{Mathematical theory in one dimension}
Before we can begin our analysis on how it is possible to numerically solve the diffusion equation, we will first take a look at the analytical solution. This analytical solution can be used in von Neumann analysis to find requirements for the numerical parameters to ensure that a reasonable solution is found.
\input{latex/analyticalonedim.tex}

\input{latex/discretisation.tex}

\input{latex/forwardeuler.tex}

\input{latex/backwardeuler.tex}

\input{latex/cranknicolson.tex}

%  _                           _ _
% | |___      _____         __| (_)_ __ ___
% | __\ \ /\ / / _ \ _____ / _` | | '_ ` _ \
% | |_ \ V  V / (_) |_____| (_| | | | | | | |
%  \__| \_/\_/ \___/       \__,_|_|_| |_| |_|
\clearpage
\section{Mathematical theory in two dimensions}
The derivation of Fick's laws can be generalised to higher dimensions, giving
\[
    \vec{J} = -D\nabla C \qquad\qquad \pdv{C}{t} = D\nabla^2C
\]
Our differential equation can therefore be written in two dimensions as
\begin{equation} \label{eq:twoDim}
\pdv[2]{u}{x} + \pdv[2]{u}{y} = \pdv{u}{t}
\end{equation}

Time and position are again discretised, with the notation \(u_{i,j,k} = u(x_i,y_j,t_k)\). For all simulations, \(\Delta y\) will be set equal to \(\Delta x\).

\input{latex/analyticaltwodim.tex}

\input{latex/eulertwodim.tex}

\clearpage
\input{latex/implementation.tex}

\clearpage
\input{latex/onedimres.tex}

\clearpage
\input{latex/twodimres.tex}

\clearpage
\input{latex/conclusion.tex}
\clearpage
\addcontentsline{toc}{section}{References}
\nocite{tveito2004introduction}
\nocite{compphys}
\printbibliography
\newpage

%\setcounter{section}{0}
%\renewcommand{\thesection}{Appendix \Alph{section}}
\input{latex/appendix.tex}


\end{document}
